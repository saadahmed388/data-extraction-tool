[
    {
        "name": "CM Old Conditions",
        "sql": "SELECT\n    account_code,\n    management_department_code,\n    customer_name,\n    risk_rank,\n    tel_number,\n    zip_code,\n    company_name,\n    company_name_kana,\n    state,\n    city,\n    oaza,\n    aza,\n    block_num,\n    building_num,\n    address_code,\n    fax_number,\n    role,\n    representative_name,\n        CASE\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) < coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) < coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) < coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_ai,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_ai\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\nEND update_date_time,\n    delete_flag,\n    sales_dealing_flag_new_vehicle,\n    sales_dealing_flag_maintenance,\n    sales_dealing_flag_used_vehicle,\n    sales_dealing_flag_insurance,\n    sales_dealing_flag_parts,\n    customer_flag,\n    module_open_flag_pt,\n    long_time_no_transaction_customer,\n    lbc,\n    responsible_service_code,\n    responsible_parts_name,\n    responsible_service_shop_code,\n    tougou,\n    parent_lbc,\n    hq_account_code,\n    responsible_nv_shop_code,\n    responsibile_shop_code,\n    responsible_service_shop_code_,\n    responsible_uv_shop_code,\n    spn_check\nFROM\n    (\n        SELECT\n            qq.*,\n            ROW_NUMBER()\n            OVER(PARTITION BY account_code\n                 ORDER BY responsible_parts_name\n            ) AS rn\n        FROM\n            (\n                SELECT DISTINCT\n                    bi.account_code,\n                    bi.tel_number,\n                    bi.zip_code,\n                    bi.company_name,\n                    bi.company_name_kana,\n                    bi.state,\n                    bi.city,\n                    bi.oaza,\n                    bi.aza,\n                    bi.block_num,\n                    bi.building_num,\n                    bi.address_code,\n                    bi.fax_number,\n                    bi.role,\n                    bi.representative_name,\n                    bi.update_date_time_bi,\n                    bi.delete_flag,\n                    bi.lbc,\n                    bi.parent_lbc,\n                    bi.hq_account_code,\n                    si.management_department_code,\n                    si.sales_dealing_flag_new_vehicle,\n                    si.sales_dealing_flag_maintenance,\n                    si.sales_dealing_flag_used_vehicle,\n                    si.sales_dealing_flag_insurance,\n                    si.sales_dealing_flag_parts,\n                    si.update_date_time_si,\n                    ai.customer_name,\n                    ai.risk_rank,\n                    ai.customer_flag,\n                    ai.update_date_time_ai,\n                    ai.module_open_flag_pt,\n                    ai.long_time_no_transaction_customer,\n                    ai.responsible_service_code,\n                    ai.responsible_parts_name,\n                    ai.responsible_service_shop_code,\n                    ai.tougou,\n                    ai.responsible_nv_shop_code,\n                    ai.responsibile_shop_code,\n                    ai.responsible_service_shop_code_,\n                    ai.responsible_uv_shop_code,\n                    ai.spn_check\n                FROM\n                    (\n                        SELECT DISTINCT\n                            ''                            role,\n                            lst.val                       state,\n                            x.x_del_flg_bas               delete_flag,\n                            x.x_rep_name                  representative_name,\n                            conaddr.x_addr_cd             address_code,\n                            conaddr.x_aza                 aza,\n                            conaddr.x_bldg_nm_room_num    building_num,\n                            conaddr.x_block_num           block_num,\n                            conaddr.x_city                city,\n                            conaddr.x_oaza                oaza,\n                            conaddr.x_state               state1,\n                            conaddr.x_zipcode             zip_code,\n                            org.main_fax_ph_num           fax_number,\n                            org.main_ph_num               tel_number,\n                            org.loc                       account_code,\n                            org.x_hqlbc                   parent_lbc,\n                            org.loc                       hq_account_code,\n                            org.name                      company_name,\n                            org.x_cmp_nm_kana             company_name_kana,\n                            org.x_lbc_cust_cd             lbc,\n                            case when org.last_upd > conaddr.last_upd then org.last_upd\n                           when org.last_upd < conaddr.last_upd then conaddr.last_upd end\n                                                          update_date_time_bi\n                        FROM\n                            siebel.s_org_ext       org,\n                            siebel.s_con_addr      conaddr,\n                            siebel.s_lst_of_val    lst,\n                            siebel.s_org_ext_x     x---,siebel.s_org_ext org1\n                        WHERE\n                            ( 1 = 1 )\n--and org1.par_row_id = org.par_ou_id\n                            AND org.ou_type_cd IN ( 'Company', 'Individual' )\n                            AND x.par_row_id = org.row_id\n                            AND org.x_con_addr_id = conaddr.row_id (+)\n                            AND conaddr.x_state = lst.name (+)\n                            AND lst.type (+) = 'MF_PREF_KANJI'\n                            AND lst.active_flg (+) = 'Y'\n                            AND lst.lang_id (+) = 'JPN'\n                    )  bi,\n                    (\n                        SELECT\n                            sa.loc                     sales_accnt,\n                            case when sa.last_upd >= sax.last_upd then sa.last_upd\n                            when sa.last_upd < sax.last_upd then sax.last_upd end\n                                                       update_date_time_si,\n                            ba.loc                     basic_accnt,\n                            ba.name                    name,\n                            deal.loc                   dealer_account_code,\n                            dep.name                   management_department_name,\n                            dep.loc                    management_department_code,\n                            sax.x_sale_deal_nv_flg     sales_dealing_flag_new_vehicle,\n                            sax.x_sale_deal_mn_flg     sales_dealing_flag_maintenance,\n                            sax.x_sale_deal_uv_flg     sales_dealing_flag_used_vehicle,\n                            sax.x_sale_deal_ins_flg    sales_dealing_flag_insurance,\n                            sax.x_sale_deal_par_flg    sales_dealing_flag_parts,\n                            sax.x_sale_deal_bus_flg    sales_dealing_flag_bus,\n                            sax.x_parts_uoe_flg        parts_uoe_user_flag\n                        FROM\n                            siebel.s_org_ext      ba,\n                            siebel.s_org_ext      sa,\n                            siebel.s_org_ext_x    sax,\n                            siebel.s_org_ext      deal,\n                            siebel.s_org_ext      dep\n                        WHERE\n                                ba.row_id = sa.par_ou_id\n                            AND sa.accnt_type_cd IN ( 'Sales', 'Finance' )\n                            AND sa.x_dlr_acunt_cd = deal.row_id (+)\n                            AND sa.par_divn_id = dep.row_id (+)\n                            AND sa.row_id = sax.par_row_id (+)\n                    )  si,\n                    (\n                        SELECT\n                            acc.x_sap_cd                 account_code,\n                            acc.name                     customer_name,\n                            ba.loc                       basic_account_code,\n                            CASE WHEN acc.last_upd > xm.last_upd then acc.last_upd\n                            WHEN xm.last_upd > acc.last_upd then xm.last_upd end\n                                                              update_date_time_ai,\n                            xm.attrib_41                 responsible_service_code,\n                            xm.attrib_49                 responsible_parts_name,\n                            xm.attrib_48                 responsible_service_shop_code,\n                            x_sls_cat_parts              module_open_flag_pt,\n                            x_no_bus_lt_flg              long_time_no_transaction_customer,\n                            t1.attrib_48                 responsible_nv_shop_code,\n                            t2.attrib_48                 responsibile_shop_code,\n                            t3.attrib_48                 responsible_service_shop_code_,\n                            t4.attrib_48                 responsible_uv_shop_code,\n                            x.x_sls_cat_all              customer_flag,\n                            x.x_pur_cat                  vendor_flag,\n                            x.x_risk_rank                risk_rank,\n                            x.x_ar_int_accnt             tougou,\n                            x.x_anti_society_category    spn_check\n                        FROM\n                            siebel.s_org_ext       acc,\n                            siebel.s_org_ext_x     x,\n                            siebel.s_org_ext_xm    xm,\n                            siebel.s_org_ext       ba,\n                            siebel.s_org_ext_xm    t1,\n                            siebel.s_org_ext_xm    t2,\n                            siebel.s_org_ext_xm    t3,\n                            siebel.s_org_ext_xm    t4\n                        WHERE\n                                acc.row_id = xm.par_row_id\n                            AND acc.par_ou_id = ba.row_id\n                            AND acc.row_id = x.par_row_id\n                            AND acc.accnt_type_cd (+) = 'Finance'\n                            AND xm.type IN ( 'AR Address', 'Parts Responsible', 'Service Responsible' )\n                            AND acc.row_id = t1.par_row_id (+)\n                            AND t1.type (+) = 'NV Responsible'\n                            AND acc.row_id = t2.par_row_id (+)\n                            AND t2.type (+) = 'Parts Responsible'\n                            AND acc.row_id = t3.par_row_id (+)\n                            AND t3.type (+) = 'Service Responsible'\n                            AND acc.row_id = t4.par_row_id (+)\n                            AND t4.type (+) = 'UV Responsible'\n                    )  ai\n                WHERE\n                        ai.basic_account_code (+) = bi.account_code\n                    AND si.basic_accnt (+) = bi.account_code\n            ) qq\n    )\nWHERE\n    rn < 2",
        "date_added_on": "2025-11-10 04:19:03",
        "date_modified_on": "2025-11-10 04:21:22",
        "class": "CM"
    },
    {
        "name": "CM New Conditions",
        "sql": "SELECT\n    account_code,\n    management_department_code,\n    customer_name,\n    risk_rank,\n    tel_number,\n    zip_code,\n    company_name,\n    company_name_kana,\n    state,\n    city,\n    oaza,\n    aza,\n    block_num,\n    building_num,\n    address_code,\n    fax_number,\n    role,\n    representative_name,\n        CASE\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) < coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) < coalesce(update_date_time_bi\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) = coalesce(update_date_time_si,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) <> coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) < coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_ai, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_ai,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_si\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_bi, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n        WHEN coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_bi,\n        TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\n             AND coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) > coalesce(update_date_time_ai\n             , TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS')) THEN\n            coalesce(update_date_time_si, TO_DATE('01-JAN-2000 10:10:10', 'dd-MON-yyyy HH24:MI:SS'))\nEND update_date_time,\n    delete_flag,\n    sales_dealing_flag_new_vehicle,\n    sales_dealing_flag_maintenance,\n    sales_dealing_flag_used_vehicle,\n    sales_dealing_flag_insurance,\n    sales_dealing_flag_parts,\n    customer_flag,\n    module_open_flag_pt,\n    long_time_no_transaction_customer,\n    lbc,\n    responsible_service_code,\n    responsible_parts_name,\n    responsible_service_shop_code,\n    tougou,\n    parent_lbc,\n    hq_account_code,\n    responsible_nv_shop_code,\n    responsibile_shop_code,\n    responsible_service_shop_code_,\n    responsible_uv_shop_code,\n    spn_check\nFROM\n    (\n        SELECT\n            qq.*,\n            ROW_NUMBER()\n            OVER(PARTITION BY account_code\n                 ORDER BY responsible_parts_name\n            ) AS rn\n        FROM\n            (\n                SELECT DISTINCT\n                    bi.account_code,\n                    bi.tel_number,\n                    bi.zip_code,\n                    bi.company_name,\n                    bi.company_name_kana,\n                    bi.state,\n                    bi.city,\n                    bi.oaza,\n                    bi.aza,\n                    bi.block_num,\n                    bi.building_num,\n                    bi.address_code,\n                    bi.fax_number,\n                    bi.role,\n                    bi.representative_name,\n                    bi.update_date_time_bi,\n                    bi.delete_flag,\n                    bi.lbc,\n                    bi.parent_lbc,\n                    bi.hq_account_code,\n                    si.management_department_code,\n                    si.sales_dealing_flag_new_vehicle,\n                    si.sales_dealing_flag_maintenance,\n                    si.sales_dealing_flag_used_vehicle,\n                    si.sales_dealing_flag_insurance,\n                    si.sales_dealing_flag_parts,\n                    si.update_date_time_si,\n                    ai.customer_name,\n                    ai.risk_rank,\n                    ai.customer_flag,\n                    ai.update_date_time_ai,\n                    ai.module_open_flag_pt,\n                    ai.long_time_no_transaction_customer,\n                    ai.responsible_service_code,\n                    ai.responsible_parts_name,\n                    ai.responsible_service_shop_code,\n                    ai.tougou,\n                    ai.responsible_nv_shop_code,\n                    ai.responsibile_shop_code,\n                    ai.responsible_service_shop_code_,\n                    ai.responsible_uv_shop_code,\n                    ai.spn_check\n                FROM\n                    (\n                        SELECT DISTINCT\n                            ''                            role,\n                            lst.val                       state,\n                            x.x_del_flg_bas               delete_flag,\n                            x.x_rep_name                  representative_name,\n                            conaddr.x_addr_cd             address_code,\n                            conaddr.x_aza                 aza,\n                            conaddr.x_bldg_nm_room_num    building_num,\n                            conaddr.x_block_num           block_num,\n                            conaddr.x_city                city,\n                            conaddr.x_oaza                oaza,\n                            conaddr.x_state               state1,\n                            conaddr.x_zipcode             zip_code,\n                            org.main_fax_ph_num           fax_number,\n                            org.main_ph_num               tel_number,\n                            org.loc                       account_code,\n                            org.x_hqlbc                   parent_lbc,\n                            org.loc                       hq_account_code,\n                            org.name                      company_name,\n                            org.x_cmp_nm_kana             company_name_kana,\n                            org.x_lbc_cust_cd             lbc,\n                            case when org.last_upd > conaddr.last_upd then org.last_upd\n                           when org.last_upd < conaddr.last_upd then conaddr.last_upd end\n                                                          update_date_time_bi\n                        FROM\n                            siebel.s_org_ext       org,\n                            siebel.s_con_addr      conaddr,\n                            siebel.s_lst_of_val    lst,\n                            siebel.s_org_ext_x     x---,siebel.s_org_ext org1\n                        WHERE\n                            ( 1 = 1 )\n--and org1.par_row_id = org.par_ou_id\n                            AND org.ou_type_cd IN ( 'Company', 'Individual' )\n                            AND x.par_row_id = org.row_id\n                            AND org.x_con_addr_id = conaddr.row_id (+)\n                            AND conaddr.x_state = lst.name (+)\n                            AND lst.type (+) = 'MF_PREF_KANJI'\n                            AND lst.active_flg (+) = 'Y'\n                            AND lst.lang_id (+) = 'JPN'\n                    )  bi,\n                    (\n                        SELECT\n                            sa.loc                     sales_accnt,\n                            case when sa.last_upd >= sax.last_upd then sa.last_upd\n                            when sa.last_upd < sax.last_upd then sax.last_upd end\n                                                       update_date_time_si,\n                            ba.loc                     basic_accnt,\n                            ba.name                    name,\n                            deal.loc                   dealer_account_code,\n                            dep.name                   management_department_name,\n                            dep.loc                    management_department_code,\n                            sax.x_sale_deal_nv_flg     sales_dealing_flag_new_vehicle,\n                            sax.x_sale_deal_mn_flg     sales_dealing_flag_maintenance,\n                            sax.x_sale_deal_uv_flg     sales_dealing_flag_used_vehicle,\n                            sax.x_sale_deal_ins_flg    sales_dealing_flag_insurance,\n                            sax.x_sale_deal_par_flg    sales_dealing_flag_parts,\n                            sax.x_sale_deal_bus_flg    sales_dealing_flag_bus,\n                            sax.x_parts_uoe_flg        parts_uoe_user_flag\n                        FROM\n                            siebel.s_org_ext      ba,\n                            siebel.s_org_ext      sa,\n                            siebel.s_org_ext_x    sax,\n                            siebel.s_org_ext      deal,\n                            siebel.s_org_ext      dep\n                        WHERE\n                                ba.row_id = sa.par_ou_id\n                            AND sa.accnt_type_cd IN ( 'Sales', 'Finance' )\n                            AND sa.x_dlr_acunt_cd = deal.row_id (+)\n                            AND sa.par_divn_id = dep.row_id (+)\n                            AND sa.row_id = sax.par_row_id (+)\n                    )  si,\n                    (\n                        SELECT\n                            acc.x_sap_cd                 account_code,\n                            acc.name                     customer_name,\n                            ba.loc                       basic_account_code,\n                            CASE WHEN acc.last_upd > xm.last_upd then acc.last_upd\n                            WHEN xm.last_upd > acc.last_upd then xm.last_upd end\n                                                              update_date_time_ai,\n                            xm.attrib_41                 responsible_service_code,\n                            xm.attrib_49                 responsible_parts_name,\n                            xm.attrib_48                 responsible_service_shop_code,\n                            x_sls_cat_parts              module_open_flag_pt,\n                            x_no_bus_lt_flg              long_time_no_transaction_customer,\n                            t1.attrib_48                 responsible_nv_shop_code,\n                            t2.attrib_48                 responsibile_shop_code,\n                            t3.attrib_48                 responsible_service_shop_code_,\n                            t4.attrib_48                 responsible_uv_shop_code,\n                            x.x_sls_cat_all              customer_flag,\n                            x.x_pur_cat                  vendor_flag,\n                            x.x_risk_rank                risk_rank,\n                            x.x_ar_int_accnt             tougou,\n                            x.x_anti_society_category    spn_check\n                        FROM\n                            siebel.s_org_ext       acc,\n                            siebel.s_org_ext_x     x,\n                            siebel.s_org_ext_xm    xm,\n                            siebel.s_org_ext       ba,\n                            siebel.s_org_ext_xm    t1,\n                            siebel.s_org_ext_xm    t2,\n                            siebel.s_org_ext_xm    t3,\n                            siebel.s_org_ext_xm    t4\n                        WHERE\n                                acc.row_id = xm.par_row_id\n                            AND acc.par_ou_id = ba.row_id\n                            AND acc.row_id = x.par_row_id\n                            AND acc.accnt_type_cd (+) = 'Finance'\n                            AND xm.type IN ( 'AR Address', 'Parts Responsible', 'Service Responsible' )\n                            AND acc.row_id = t1.par_row_id (+)\n                            AND t1.type (+) = 'NV Responsible'\n                            AND acc.row_id = t2.par_row_id (+)\n                            AND t2.type (+) = 'Parts Responsible'\n                            AND acc.row_id = t3.par_row_id (+)\n                            AND t3.type (+) = 'Service Responsible'\n                            AND acc.row_id = t4.par_row_id (+)\n                            \n                            AND t4.type (+) = 'UV Responsible'\n                            \n                            \n                    )  ai\n                WHERE\n                        ai.basic_account_code (+) = bi.account_code\n                    AND si.basic_accnt (+) = bi.account_code\n            ) qq\n    )\nWHERE\n    rn < 2\n    AND NOT (\n    NVL(responsible_nv_shop_code, '9999') = '9999' AND\n    NVL(responsibile_shop_code, '9999') = '9999' AND\n    NVL(responsible_service_shop_code_, '9999') = '9999' AND\n    NVL(responsible_uv_shop_code, '9999') = '9999'\n)",
        "date_added_on": "2025-11-10 04:21:01",
        "date_modified_on": "2025-11-10 04:21:47",
        "class": "CM"
    },
    {
        "name": "VM",
        "sql": "SELECT DISTINCT OWNER.LOC,\n    CON.PERSON_UID,\n    VEH.LCNS_NUM,\n    VEH.X_LAND_TRNS_BUR_NAME,--changed for 22177\n    VEH.X_CLASSIFICATION_NUM,\n    VEH.X_REG_NUM_JAP_KANA,\n    VEH.X_REG_NUM_SERIAL_NUM,\n    VEH.SERIAL_NUM,\n    VEH.X_STMPD_VHCL_NUM,\n    VEH.X_VHCL_NUM_MNU_NUM,\n    OWNER.NAME,--Changed for Defect 22176\n    ADDR.X_ZIPCODE,\n    trim(STA.VAL    \n    ||ADDR.X_CITY    \n    ||ADDR.X_OAZA    \n    ||ADDR.X_AZA    \n    ||ADDR.X_BLOCK_NUM    \n    ||ADDR.X_BLDG_NM_ROOM_NUM) ,--Changed for Defect 22176\n    '',\n    TO_CHAR(VEH.REGISTERED_DT,'YYYYMM'),\n    TO_CHAR(VEH.REGISTERED_DT,'YYYY'),\n    TO_CHAR(VEH.REGISTERED_DT,'MM'),\n    TO_CHAR(VEH.END_DT,'YYYY'),\n    TO_CHAR(VEH.END_DT,'MM'),\n    TO_CHAR(VEH.END_DT,'DD'),\n    BRAND.VAL,\n    VEHTYPE.VAL,\n    VEHCL.VAL,\n    BCL.VAL,\n    FIN.NAME,--changed as per Logesh Confirmation 10/1/2019\n    OWNER.MAIN_PH_NUM,\n    SERV.LOC,\n    SERV.NAME,\n    POSCON.EMP_NUM,\n    POSCON.LAST_NAME,\n    TO_CHAR(JC.CREATED,'YYYYMMDD'),\n    JC.ODOMTR_RDNG,\n    JC.SR_NUM,\n    DEALER.LOC,\n    JC.X_WORKSHOP_CODE,\n    SOBR.NAME,\n    OPTYCR.EMP_NUM,\n    ORDCR.LAST_NAME,\n    VEH.X_REG_MODEL_CODE,\n    VEH.X_STAMP_ENGINE_MDCODE,\n    VEHX.X_CLASS,\n    USRBR.LOC,--changed for 22177\n    FINBRANCH.NAME,\n    FINXM.ATTRIB_49,\n    FINXM.ATTRIB_41,\n    '',\n    '',\n    VEH.X_LAND_TRNS_BUR_CODE,\n    '',\n    VEH.LCNS_NUM,\n    TO_CHAR(VEHX.X_SCRAP_DATE,'YYYYMMDD'),\n    TO_CHAR(VEH.LAST_UPD,'YYYYMMDD'),\n    TO_CHAR(VEH.REGISTERED_DT,'YYYYMMDD'),\n    '',\n    VEH.SERIAL_NUM,\n    '',\n    '',\n    VEH.X_STMPD_VHCL_NUM,\n    trim(ADDPR.X_PRFCTUR_CD1\t\n    ||ADDPR.X_CTY_CNTY_CD1\t\n    ||ADDPR.X_OOAZA_CD1\t\n    ||ADDPR.X_AZA_CD1),--Changed for Defect 22176/removed field seperator for CR 22177\n    ADDR.X_ZIPCODE,\n    '',\n    VEHTYPE.VAL,\n    BRAND.VAL,\n    OWNER.NAME,--Changed for Defect 22176\n    trim(STA.VAL    \n    ||ADDR.X_CITY    \n    ||ADDR.X_OAZA    \n    ||ADDR.X_AZA    \n    ||ADDR.X_BLOCK_NUM    \n    ||ADDR.X_BLDG_NM_ROOM_NUM),--Changed for Defect 22176\n    '',\n    VEHX.X_VHCL_INS_FLG,\n    VEHX.ATTRIB_40,\n    VEH.status_cd,\n    VEH.sub_status_cd,\n VEH.X_VEHICLE_TYPE_CODE\n  FROM SIEBEL.S_ASSET VEH,\n    SIEBEL.S_ORG_EXT OWNER,\n    SIEBEL.S_CONTACT CON,\n    (SELECT ACCNT_ID,ADDR_PER_ID,X_STATE,X_CITY,X_OAZA,X_AZA,X_BLOCK_NUM,X_BLDG_NM_ROOM_NUM,X_ZIPCODE FROM \n(SELECT ACCNT_ID,ADDR_PER_ID,X_STATE,X_CITY,X_OAZA,X_AZA,X_BLOCK_NUM,X_BLDG_NM_ROOM_NUM,X_ZIPCODE,\n DENSE_RANK() over (partition BY ACCNT_ID,ADDR_PER_ID order by CREATED DESC) rank1\n FROM SIEBEL.S_CON_ADDR )\n WHERE rank1=1) ADDR,\n SIEBEL.S_ADDR_PER ADDPR,--Changed for Defect 22176\n    SIEBEL.S_ASSET_X VEHX,\n    SIEBEL.S_ORG_EXT SERV,\n    SIEBEL.S_POSTN POSTN,\n    SIEBEL.S_CONTACT POSCON,\n    --SIEBEL.S_VHCL_SRV SRV,\n    --SIEBEL.S_SRV_REQ SR,\n    SIEBEL.S_ORG_EXT DEALER,\n    --SIEBEL.S_ORDER SO,\n    --SIEBEL.S_ORDER_TYPE SOP,\n    SIEBEL.S_ORG_EXT SOBR,\n    SIEBEL.S_OPTY OPTY,\n    SIEBEL.S_CONTACT OPTYCR,\n    SIEBEL.S_CONTACT ORDCR,\n    SIEBEL.S_ORG_EXT FIN,\n    SIEBEL.S_ORG_EXT_XM FINXM,\n    SIEBEL.S_ORG_EXT FINBRANCH,\n    SIEBEL.S_LST_OF_VAL BRAND,\n    SIEBEL.S_LST_OF_VAL VEHTYPE,\n    SIEBEL.S_LST_OF_VAL VEHCL,\n    SIEBEL.S_LST_OF_VAL BCL,\n    SIEBEL.S_LST_OF_VAL STA,--Changed for Defect 22176\n    SIEBEL.S_USER USR,--Changed for 22177\n    SIEBEL.S_CONTACT CONUSR,--Changed for 22177\n    SIEBEL.S_ORG_EXT USRBR,--Changed for 22177\n    (SELECT CREATED,\n      VHCL_ID,\n      ODOMTR_RDNG,\n      SR_NUM,\n      BU_ID,\n      X_WORKSHOP_CODE\n    FROM\n      (SELECT SR.CREATED,\n        SRV.VHCL_ID,\n        SR.ODOMTR_RDNG,\n        SR.SR_NUM,\n        SR.BU_ID,\n        SRV.X_WORKSHOP_CODE ,\n        DENSE_RANK() over (partition BY SRV.VHCL_ID order by SR.created DESC) rank1\n      FROM SIEBEL.S_VHCL_SRV SRV,\n        SIEBEL.S_SRV_REQ SR\n      WHERE SR.SR_CAT_TYPE_CD='Job Card'\n      AND SR.ROW_ID          =SRV.SRV_REQ_ID\n      )\n    WHERE rank1=1\n    ) JC,\n    (SELECT A.BU_ID,\n      A.ROW_ID,\n      A.OPTY_ID,\n      A.X_VEHICLE_ID,\n      A.CREATED_BY\n    FROM SIEBEL.S_ORDER A,\n      SIEBEL.S_ORDER_TYPE B\n    WHERE A.ORDER_TYPE_ID=B.ROW_ID\n    AND B.NAME           = 'Sales Order'\n    AND A.STATUS_CD      = 'Sales Posting Completed'\n    )SO\n  WHERE VEH.TYPE_CD          ='Vehicle'\n  AND VEH.X_USR_ONR_ACC_ID   =OWNER.ROW_ID(+)\n  AND VEH.X_BILL_CONT_CD     =CON.ROW_ID(+)\n  AND OWNER.ROW_ID           =ADDR.ACCNT_ID(+)\n  AND ADDR.ADDR_PER_ID = ADDPR.ROW_ID(+)\n  AND VEH.ROW_ID             =VEHX.PAR_ROW_ID(+)\n  AND VEH.PREF_SRV_DLR_ID    =SERV.ROW_ID(+)\n  AND VEH.PR_POSTN_ID        =POSTN.ROW_ID(+)\n  AND POSTN.PR_EMP_ID        =POSCON.ROW_ID(+)\n  AND VEH.ROW_ID             =JC.VHCL_ID(+)\n  AND JC.BU_ID               =DEALER.ROW_ID(+)\n  AND VEH.ROW_ID             =SO.X_VEHICLE_ID(+)\n  AND SO.OPTY_ID             =OPTY.ROW_ID(+)\n  AND OPTY.CREATED_BY        =OPTYCR.ROW_ID(+)\n  AND SO.CREATED_BY          =ORDCR.ROW_ID(+)\n  AND SO.BU_ID               =SOBR.ROW_ID(+)\n  AND OWNER.ROW_ID           =FIN.PAR_OU_ID(+)\n  AND FIN.ROW_ID=FINXM.PAR_ROW_ID(+)\n  AND FINXM.ATTRIB_48        =FINBRANCH.X_4_DIGIT_CD(+)\n  AND FINXM.NAME(+)          ='NV Responsible'\n  AND FIN.ACCNT_TYPE_CD(+)   ='Finance'\n  AND FINXM.ATTRIB_42= USR.LOGIN(+)--Changed for 22177\n  AND USR.ROW_ID=CONUSR.ROW_ID(+)--Changed for 22177\n  AND CONUSR.BU_ID= USRBR.ROW_ID(+)--Changed for 22177\n  AND VEH.MAKE_CD            =BRAND.NAME(+)\n  AND BRAND.TYPE(+)          ='AUTO_MAKE_TYPE'\n  AND BRAND.LANG_ID(+)       ='JPN'\n  AND VEH.X_VEHICLE_TYPE_CODE=VEHTYPE.NAME(+)\n  AND VEHTYPE.TYPE(+)        ='MF_VEHICLE_TYPE'\n  AND VEHTYPE.LANG_ID(+)     ='JPN'\n  AND VEHX.X_VHCL_INS_CLS    =VEHCL.NAME(+)\n  AND VEHCL.TYPE(+)          ='MF_VEH_INS_CLS'\n  AND VEHCL.LANG_ID(+)       ='JPN'\n  AND VEHTYPE.ACTIVE_FLG = 'Y'\n  AND VEHX.X_BSNS_CLS        =BCL.NAME(+)\n  AND BCL.TYPE(+)            ='BUSINESS_CLS'\n  AND BCL.LANG_ID(+)         ='JPN'\n  AND ADDR.X_STATE = STA.NAME(+)--Changed for Defect 22176\n  AND STA.TYPE(+)= 'MF_PREF_KANJI'--Changed for Defect 22176\n  AND STA.LANG_ID(+) = 'JPN'\n  AND VEH.status_cd not in ('Permanent Deregistration(EOL)')\n  AND VEH.sub_status_cd not in ('Permanent Deregistration')",
        "date_added_on": "2025-11-10 04:23:45",
        "date_modified_on": "2025-11-10 04:24:14",
        "class": "VM"
    },
    {
        "name": "CM Ikezawa",
        "sql": "select * from (\nWITH AR_ADDRESS AS (\n    SELECT \n        PAR_ROW_ID,\n        LAST_UPD,\n        ATTRIB_38,\n        ATTRIB_41,\n        ATTRIB_03,\n        ATTRIB_39,\n        ATTRIB_48,\n        ATTRIB_02,\n        ATTRIB_01,\n        ATTRIB_36,\n        ATTRIB_35,\n        ATTRIB_34,\n        ROW_NUMBER() OVER (PARTITION BY PAR_ROW_ID ORDER BY LAST_UPD DESC) AS RN\n    FROM \n        SIEBEL.S_ORG_EXT_XM\n    WHERE \n        TYPE = 'AR Address'\n),\nAP_ADDRESS AS (\n    SELECT \n        PAR_ROW_ID,\n        LAST_UPD,\n        ATTRIB_03,\n        ATTRIB_36,\n        ATTRIB_35,\n        ATTRIB_34,\n        ROW_NUMBER() OVER (PARTITION BY PAR_ROW_ID ORDER BY LAST_UPD DESC) AS RN\n    FROM \n        SIEBEL.S_ORG_EXT_XM\n    WHERE \n        TYPE = 'AP Address'\n),\nNV_RESPONSIBLE AS (\n    SELECT \n        PAR_ROW_ID,\n        LAST_UPD,\n        ATTRIB_48,\n        ATTRIB_49,\n        ATTRIB_41,\n        ATTRIB_03,\n        ATTRIB_36,\n        ATTRIB_47,\n        ROW_NUMBER() OVER (PARTITION BY PAR_ROW_ID ORDER BY LAST_UPD DESC) AS RN\n    FROM \n        SIEBEL.S_ORG_EXT_XM\n    WHERE \n        TYPE = 'NV Responsible'\n),\nUV_RESPONSIBLE AS (\n    SELECT \n        PAR_ROW_ID,\n        LAST_UPD,\n        ATTRIB_48,\n        ATTRIB_49,\n        ATTRIB_41,\n        ATTRIB_03,\n        ATTRIB_36,\n        ATTRIB_47,\n        ROW_NUMBER() OVER (PARTITION BY PAR_ROW_ID ORDER BY LAST_UPD DESC) AS RN\n    FROM \n        SIEBEL.S_ORG_EXT_XM\n    WHERE \n        TYPE = 'UV Responsible'\n),\nPARTS_RESPONSIBLE AS (\n    SELECT \n        PAR_ROW_ID,\n        LAST_UPD,\n        ATTRIB_48,\n        ATTRIB_49,\n        ATTRIB_41,\n        ATTRIB_03,\n        ATTRIB_36,\n        ATTRIB_47,\n        ROW_NUMBER() OVER (PARTITION BY PAR_ROW_ID ORDER BY LAST_UPD DESC) AS RN\n    FROM \n        SIEBEL.S_ORG_EXT_XM\n    WHERE \n        TYPE = 'Parts Responsible'\n),\nSERVICE_RESPONSIBLE AS (\n    SELECT \n        PAR_ROW_ID,\n        LAST_UPD,\n        ATTRIB_48,\n        ATTRIB_49,\n        ATTRIB_41,\n        ATTRIB_03,\n        ATTRIB_36,\n        ATTRIB_47,\n        ROW_NUMBER() OVER (PARTITION BY PAR_ROW_ID ORDER BY LAST_UPD DESC) AS RN\n    FROM \n        SIEBEL.S_ORG_EXT_XM\n    WHERE \n        TYPE = 'Service Responsible'\n)\nSELECT DISTINCT\n\n      T1.loc as CUSTOMER_CODE,\n      T1.NAME as CUSTOMER_NAME,\n      REPLACE(REPLACE(TRIM(T1.X_CMP_NM_KANA), CHR(10), ''), CHR(13), '') as CUSTOMER_NAME_KANA,\n      SUBSTR(T31.X_ZIPCODE, 1, 3) || '-' || SUBSTR(T31.X_ZIPCODE, 4, length(T31.X_ZIPCODE)-3) AS ZIP_CODE,\n      (T33.val ||' '|| T32.X_CNT_CTY_NM_KNJ ||' '|| T32.ADDR_LINE_3 ||' '|| T32.ADDR_LINE_4 || ' ' || T31.X_BLOCK_NUM ||' '|| T31.X_BLDG_NM_ROOM_NUM) as CUSTOMER_ADDRESS,\n      T2.MAIN_PH_NUM as TEL_NUM,\n--      REPLACE(REPLACE(TRIM(T2.X_SAP_CD), CHR(10), ''), CHR(13), '') as CUSTOMER_CODE, \n--      REPLACE(REPLACE(TRIM(T2.X_CMP_NM_ENG), CHR(10), ''), CHR(13), '') as CUSTOMER_NAME_E,\n--      REPLACE(REPLACE(TRIM(T2.NAME), CHR(10), ''), CHR(13), '') as CUSTOMER_NAME_KANA, \n--      T31.X_ZIPCODE as ZIP_CODE,\n--   T33.VAL as PREFECTURE_NAME,\n--      --T32.X_PRFCTUR_CD1 as PREFECTURE_CODE,\n--   T32.X_CNT_CTY_NM_KNJ as CITY_COUNTY_NAME,\n--      T32.ADDR_LINE_3 AS OOAZA_Name,\n--      T32.ADDR_LINE_4 as AZA_CHOME,\n--   T31.X_BLOCK_NUM as BLOCK_NUM,\n--      T31.X_BLDG_NM_ROOM_NUM as BUILD_NAME_ROOM_NUM,\n--      T2.MAIN_PH_NUM as TEL_NUM,\n\n      REPLACE(REPLACE(TRIM(T25.ATTRIB_48), CHR(10), ''), CHR(13), '') as RESPONSBLE_SERVICE_SHOP_CODE,\n      REPLACE(REPLACE(TRIM(T25.ATTRIB_49), CHR(10), ''), CHR(13), '') as RESPONSBLE_SERVICE_CODE,\n      REPLACE(REPLACE(TRIM(T25.ATTRIB_41), CHR(10), ''), CHR(13), '') as RESPONSBLE_SERVICE_NAME,\n      REPLACE(REPLACE(TRIM(T25.ATTRIB_03), CHR(10), ''), CHR(13), '') as RESPONSBLE_SERVICE_TEL,\n   REPLACE(REPLACE(TRIM(T22.ATTRIB_48), CHR(10), ''), CHR(13), '') as RESPONSBLE_NV_SHOP_CODE,\n      REPLACE(REPLACE(TRIM(T22.ATTRIB_49), CHR(10), ''), CHR(13), '') as RESPONSBLE_NV_CODE,\n      REPLACE(REPLACE(TRIM(T22.ATTRIB_41), CHR(10), ''), CHR(13), '') as RESPONSBLE_NV_NAME,\n      REPLACE(REPLACE(TRIM(T22.ATTRIB_03), CHR(10), ''), CHR(13), '') as RESPONSBLE_NV_TEL,\n      (SELECT VAL FROM SIEBEL.S_LST_OF_VAL WHERE TYPE = 'MF_RISK_RANK' AND NAME = T4.X_RISK_RANK  OFFSET 1 ROW FETCH NEXT 1 ROW ONLY) AS \"RISK_RANK\",\n      CASE REPLACE(REPLACE(TRIM(T4.X_ANTI_SOCIETY_CATEGORY), CHR(10), ''), CHR(13), '') \n        WHEN 'N' THEN 'No'\n        WHEN 'Y' THEN 'Yes'\n      END as SPN_CHECK,   \n      REPLACE(REPLACE(TRIM((CASE T4.X_NO_BUS_LT_FLG WHEN 'Y' THEN 'Yes' WHEN 'N' THEN 'No' ELSE 'No' END)), CHR(10), ''), CHR(13), '') as LONGTIME_TRANS_CUSTOMER,\n      REPLACE(REPLACE(TRIM((CASE T4.X_SLS_CAT_MNTNCE WHEN 'Y' THEN 'Yes' WHEN 'N' THEN 'No' ELSE 'No' END)), CHR(10), ''), CHR(13), '') as MODULE_FLG_SV\nFROM \n    SIEBEL.S_ORG_EXT T1\nLEFT OUTER JOIN \n    SIEBEL.S_ORG_EXT T2 ON T1.ROW_ID = T2.PAR_OU_ID\n    AND T2.ACCNT_TYPE_CD in ('Finance')\nLEFT JOIN \n    AR_ADDRESS T3 ON T2.ROW_ID = T3.PAR_ROW_ID AND T3.RN = 1\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_X T4 ON T2.ROW_ID = T4.PAR_ROW_ID AND T4.X_SLS_CAT_ALL = 'Y'\nLEFT JOIN \n    SIEBEL.S_LST_OF_VAL LOV ON LOV.VAL = T4.X_ACCOUNT_TYPE AND LOV.TYPE = 'MF_VIR_ACC_TYPE'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT T5 ON T1.ROW_ID = T5.PAR_OU_ID AND T5.ACCNT_TYPE_CD = 'Finance'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_X T6 ON T5.ROW_ID = T6.PAR_ROW_ID AND T6.X_PUR_CAT = 'Y'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T7 ON T2.ROW_ID = T7.PAR_ROW_ID AND T7.X_PAYMENT_TYPE = 'Vehicle'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T8 ON T2.ROW_ID = T8.PAR_ROW_ID AND T8.TYPE = 'AR Payment Terms' AND T8.X_PAYMENT_TYPE = 'Customer Service'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T9 ON T5.ROW_ID = T9.PAR_ROW_ID AND T9.TYPE = 'AP Payment Terms' AND T9.X_PAYMENT_TYPE = 'Purchasing'\nLEFT JOIN \n    AP_ADDRESS T10 ON T2.ROW_ID = T10.PAR_ROW_ID AND T10.RN = 1\nLEFT JOIN \n    SIEBEL.S_PARTY T11 ON T11.ROW_ID = T2.PAR_ROW_ID\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T12 ON T11.ROW_ID = T12.PAR_ROW_ID AND T12.TYPE = 'HIST1'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T13 ON T11.ROW_ID = T13.PAR_ROW_ID AND T13.TYPE = 'HIST2'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T14 ON T11.ROW_ID = T14.PAR_ROW_ID AND T14.TYPE = 'HIST3'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T15 ON T11.ROW_ID = T15.PAR_ROW_ID AND T15.TYPE = 'HIST4'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T16 ON T11.ROW_ID = T16.PAR_ROW_ID AND T16.TYPE = 'HIST5'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_FNXM T17 ON T11.ROW_ID = T17.PAR_ROW_ID AND T17.ATTRIB_04 = 'CD01'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_FNXM T18 ON T11.ROW_ID = T18.PAR_ROW_ID AND T18.ATTRIB_04 = 'CM01'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_FNXM T19 ON T11.ROW_ID = T19.PAR_ROW_ID AND T19.ATTRIB_04 = 'VM01'\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_FNXM T20 ON T11.ROW_ID = T20.PAR_ROW_ID AND T20.ATTRIB_04 = 'VD01'\nLEFT JOIN \n    SIEBEL.S_LST_OF_VAL T21 ON T2.X_HONORIFIC = T21.NAME AND T21.TYPE = 'MF_HONORIFIC' AND T21.LANG_ID = 'JPN'\nLEFT JOIN \n    NV_RESPONSIBLE T22 ON T11.ROW_ID = T22.PAR_ROW_ID AND T22.RN = 1\nLEFT JOIN \n    UV_RESPONSIBLE T23 ON T11.ROW_ID = T23.PAR_ROW_ID AND T23.RN = 1\nLEFT JOIN \n    PARTS_RESPONSIBLE T24 ON T11.ROW_ID = T24.PAR_ROW_ID AND T24.RN = 1\nLEFT JOIN \n    SERVICE_RESPONSIBLE T25 ON T11.ROW_ID = T25.PAR_ROW_ID AND T25.RN = 1\nLEFT JOIN \n    SIEBEL.S_ORG_EXT_XM T26 ON T11.ROW_ID = T26.PAR_ROW_ID \n    AND T26.X_PAYMENT_TYPE = 'Comp Code'\nLEFT JOIN \n    SIEBEL.S_SRV_REQ T27 ON T11.ROW_ID = T27.CST_OU_ID\nLEFT JOIN \n    SIEBEL.S_SRV_REQ T28 ON T2.X_CUST_ID = T28.ROW_ID\nLEFT JOIN \n SIEBEL.S_CON_ADDR T31 ON T1.X_CON_ADDR_ID = T31.ROW_ID\nLEFT JOIN \n SIEBEL.S_ADDR_PER T32 ON T31.ADDR_PER_ID = T32.ROW_ID\nLEFT JOIN \n    siebel.s_lst_of_val T33 ON T33.Name  = T32.X_PRFCTUR_NM_KNJ\n\nWHERE \n    T1.OU_TYPE_CD IN ('Company', 'Employee', 'Individual')\n    AND ((T33.TYPE = 'MF_PREF_KANJI' \n    AND T33.LANG_ID = 'JPN')\n    or T33.TYPE is null))",
        "date_added_on": "2025-12-11 20:56:22",
        "date_modified_on": "2026-01-11 03:04:58",
        "class": "CM"
    },
    {
        "name": "VM Ikezawa",
        "sql": "SELECT \n    distinct VEH.SERIAL_NUM as \"Chassis #\",\n VEH.ROW_ID AS ID,\n    VEHX.ATTRIB_07 as \"Authorized Re-Stamping\",\n    VEH.X_LAND_TRNS_BUR_NAME as \"Land transport bureau name_Region name\",--changed for 22177\n    VEH.X_CLASSIFICATION_NUM as \"Classification\",\n    VEH.X_REG_NUM_JAP_KANA AS \"Japanese kana\",\n    VEH.X_REG_NUM_SERIAL_NUM as \"Serial #\",\n    VEH.X_LAND_TRNS_BUR_NAME || '-' || VEH.X_CLASSIFICATION_NUM || '-' || VEH.X_REG_NUM_JAP_KANA || '-' || VEH.X_REG_NUM_SERIAL_NUM as \"REGISTRATION_NO\",\n    --VEH.LCNS_NUM as \"Registration No.\",\n VEHX.X_VHCL_MNGMNT_NUM as \"Vehicle management No.\",\n    VEHX.X_CLASS as \"Class\",\n    TO_CHAR(VEH.REGISTERED_DT,'YYYY/MM/DD') as \"Initial Registration Year Month\",\n    TO_CHAR(VEH.END_DT,'YYYY/MM/DD') as \"Shaken Expiration Date\",\n    REPLACE(VEHX.X_VHCL_INS_FLG, 'year', '\u5e74') as \"Inspection Span Flag\",\n    --VEHX.X_BSNS_CLS as \"Private or Business Use Type\",\n    BCL.VAL as \"Private or Business Use Type\",\n    VEHX.ATTRIB_40 as \"Emmision Code\",\n    TO_CHAR(VEH.X_LOAD_CAPACITY) as \"Load Capacity\",\n    TO_CHAR(VEHATX.ODOMTR_RCPT) as \"Maximum Mileage\",\n    VEH.X_STAMP_ENGINE_MDCODE as \"Engine Model Code/Number\",\n    SERV.LOC as \"Code of Branch in charge of service\",\n    SERV.NAME as \"Name of Branch in charge of service\",\n    POSCON.EMP_NUM as \"Code of personnel in charge of service\",\n    POSCON.LAST_NAME as \"Name of Personnel in charge of service\",\n    VEH.X_AGREE_NUM as \"Contract Number\",\n    VEH.X_AGR_START_DT as \"Contract Start\",\n    VEH.X_AGR_END_DT as \"Contract End\",\n    VEHX.X_SRC_CNTRCT_CLS as \"Service Type\",\n    --VEH.MAKE_CD as \"Brand\",\n    BRAND.VAL as \"Brand\",\n    VEH.X_GROSS_WEIGHT as \"Gross Weight\",\n    VEHX.X_DE_REG_FLG as \"De-Registration Flag\",\n    TO_CHAR(VEHX.X_DE_REG_DATE, 'YYYY/MM/DD') as \"Date Of Deregistration\",\n    VEHX.X_SCRAP_FLG as \"Scraped Flag\",\n    TO_CHAR(VEHX.X_SCRAP_DATE,'YYYY/MM/DD') as \"Scrap Date\",\n    OWNER.LOC as \"User\",\n    OWNERNEW.LOC as \"Owner\"\n --self-employed category\n --linked registration no.\n\nFROM SIEBEL.S_ASSET VEH,\n    SIEBEL.S_ORG_EXT OWNER,\n    SIEBEL.S_ORG_EXT OWNERNEW,\n    SIEBEL.S_CONTACT CON,\n    (SELECT ACCNT_ID, ADDR_PER_ID, X_STATE, X_CITY, X_OAZA, X_AZA, X_BLOCK_NUM, X_BLDG_NM_ROOM_NUM, X_ZIPCODE \n     FROM (\n         SELECT ACCNT_ID, ADDR_PER_ID, X_STATE, X_CITY, X_OAZA, X_AZA, X_BLOCK_NUM, X_BLDG_NM_ROOM_NUM, X_ZIPCODE,\n         DENSE_RANK() over (PARTITION BY ACCNT_ID, ADDR_PER_ID ORDER BY CREATED DESC) rank1\n         FROM SIEBEL.S_CON_ADDR\n     ) \n     WHERE rank1 = 1\n    ) ADDR,\n    SIEBEL.S_ADDR_PER ADDPR,--Changed for Defect 22176\n    SIEBEL.S_ASSET_X VEHX,\n    SIEBEL.S_ASSET_ATX VEHATX,\n    SIEBEL.S_ORG_EXT SERV,\n    SIEBEL.S_POSTN POSTN,\n    SIEBEL.S_CONTACT POSCON,\n    SIEBEL.S_ORG_EXT DEALER,\n    SIEBEL.S_ORG_EXT SOBR,\n    SIEBEL.S_OPTY OPTY,\n    SIEBEL.S_CONTACT OPTYCR,\n    SIEBEL.S_CONTACT ORDCR,\n    SIEBEL.S_ORG_EXT FIN,\n    SIEBEL.S_ORG_EXT_XM FINXM,\n    SIEBEL.S_ORG_EXT FINBRANCH,\n    SIEBEL.S_LST_OF_VAL BRAND,\n    SIEBEL.S_LST_OF_VAL VEHTYPE,\n    --SIEBEL.S_LST_OF_VAL VEHCL,\n    SIEBEL.S_LST_OF_VAL BCL,\n    SIEBEL.S_LST_OF_VAL STA,--Changed for Defect 22176\n    SIEBEL.S_USER USR,--Changed for 22177\n    SIEBEL.S_CONTACT CONUSR,--Changed for 22177\n    SIEBEL.S_ORG_EXT USRBR,--Changed for 22177\n    (SELECT CREATED, VHCL_ID, ODOMTR_RDNG, SR_NUM, BU_ID, X_WORKSHOP_CODE\n     FROM (\n         SELECT SR.CREATED, SRV.VHCL_ID, SR.ODOMTR_RDNG, SR.SR_NUM, SR.BU_ID, SRV.X_WORKSHOP_CODE,\n         DENSE_RANK() over (PARTITION BY SRV.VHCL_ID ORDER BY SR.CREATED DESC) rank1\n         FROM SIEBEL.S_VHCL_SRV SRV,\n              SIEBEL.S_SRV_REQ SR\n         WHERE SR.SR_CAT_TYPE_CD = 'Job Card'\n         AND SR.ROW_ID = SRV.SRV_REQ_ID\n     ) \n     WHERE rank1 = 1\n    ) JC,\n    (SELECT A.BU_ID, A.ROW_ID, A.OPTY_ID, A.X_VEHICLE_ID, A.CREATED_BY\n     FROM SIEBEL.S_ORDER A,\n          SIEBEL.S_ORDER_TYPE B\n     WHERE A.ORDER_TYPE_ID = B.ROW_ID\n     AND B.NAME = 'Sales Order'\n     AND A.STATUS_CD = 'Sales Posting Completed'\n    ) SO\n\nWHERE VEH.TYPE_CD = 'Vehicle'\n  AND VEH.ROW_ID = VEHATX.ROW_ID(+)\n  AND VEH.X_USR_ONR_ACC_ID = OWNER.ROW_ID(+)\n  AND VEH.OWNER_ACCNT_ID = OWNERNEW.PAR_ROW_ID(+)\n  AND VEH.X_BILL_CONT_CD = CON.ROW_ID(+)\n  AND OWNER.ROW_ID = ADDR.ACCNT_ID(+)\n  AND ADDR.ADDR_PER_ID = ADDPR.ROW_ID(+)\n  AND VEH.ROW_ID = VEHX.PAR_ROW_ID(+)\n  AND VEH.PREF_SRV_DLR_ID = SERV.ROW_ID(+)\n  AND VEH.PR_POSTN_ID = POSTN.ROW_ID(+)\n  AND POSTN.PR_EMP_ID = POSCON.ROW_ID(+)\n  AND VEH.ROW_ID = JC.VHCL_ID(+)\n  AND JC.BU_ID = DEALER.ROW_ID(+)\n  AND VEH.ROW_ID = SO.X_VEHICLE_ID(+)\n  AND SO.OPTY_ID = OPTY.ROW_ID(+)\n  AND OPTY.CREATED_BY = OPTYCR.ROW_ID(+)\n  AND SO.CREATED_BY = ORDCR.ROW_ID(+)\n  AND SO.BU_ID = SOBR.ROW_ID(+)\n  AND OWNER.ROW_ID = FIN.PAR_OU_ID(+)\n  AND FIN.ROW_ID = FINXM.PAR_ROW_ID(+)\n  AND FINXM.ATTRIB_48 = FINBRANCH.X_4_DIGIT_CD(+)\n  AND FINXM.NAME(+) = 'NV Responsible'\n  AND FIN.ACCNT_TYPE_CD(+) = 'Finance'\n  AND FINXM.ATTRIB_42 = USR.LOGIN(+)--Changed for 22177\n  AND USR.ROW_ID = CONUSR.ROW_ID(+)--Changed for 22177\n  AND CONUSR.BU_ID = USRBR.ROW_ID(+)--Changed for 22177\n  AND VEH.MAKE_CD = BRAND.NAME(+)\n  AND BRAND.TYPE(+) = 'AUTO_MAKE_TYPE'\n  AND BRAND.LANG_ID(+) = 'JPN'\n  AND VEH.X_VEHICLE_TYPE_CODE = VEHTYPE.NAME(+)\n  AND VEHTYPE.TYPE(+) = 'MF_VEHICLE_TYPE'\n  AND VEHTYPE.LANG_ID(+) = 'JPN'\n--  AND VEHX.X_VHCL_INS_CLS = VEHCL.NAME(+)\n--  AND VEHCL.TYPE(+) = 'MF_VEH_INS_CLS'\n--  AND VEHCL.LANG_ID(+) = 'JPN'\n--  AND VEHTYPE.ACTIVE_FLG = 'Y'\n  AND VEHX.X_BSNS_CLS = BCL.NAME(+)\n  AND BCL.TYPE(+) = 'BUSINESS_CLS'\n  AND BCL.LANG_ID(+) = 'JPN'\n  AND ADDR.X_STATE = STA.NAME(+)--Changed for Defect 22176\n  AND STA.TYPE(+) = 'MF_PREF_KANJI'--Changed for Defect 22176\n  AND STA.LANG_ID(+) = 'JPN'",
        "date_added_on": "2025-12-11 20:56:54",
        "date_modified_on": "2026-01-11 05:13:31",
        "class": "VM"
    }
]